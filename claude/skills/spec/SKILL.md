---
name: spec
description: issue/PRから仕様整理→影響範囲調査→実装方針作成までを一括で行う。「仕様整理」「spec」と依頼された際に使用。
argument-hint: <issue-url または issue番号>
---

指定されたissue/PRの仕様を整理し、影響範囲を調査し、実装方針を作成してください。

## 入力
$ARGUMENTS

## ワークフロー

### Phase 1: 仕様整理
1. requirements-analyst エージェントを使用して仕様書を作成
2. エージェントが仕様書を `docs/specs/` に出力するまで待つ
3. 作成された仕様書の概要を報告

### Phase 2: 実装方針作成（影響範囲調査を含む）
1. Phase 1で作成した仕様書のパスをPlanエージェントに渡す
2. **Planエージェントに以下を指示**:
   - 仕様書を読み込む
   - `impact-analysis` スキルを使って影響範囲を調査する
   - 影響範囲の調査結果を踏まえて実装計画を作成する
   - 計画書を `docs/specs/{issue番号}.plan.md` に出力する

### Planエージェントへの指示内容
```
以下の仕様書に基づいて実装計画を作成してください。

## 仕様書
{Phase 1で作成した仕様書のパス}

## 手順
1. 仕様書を読み込み、要件を理解する
2. `impact-analysis` スキルを使用して影響範囲を調査する
   - 変更が必要なインターフェース・クラスを特定
   - 実装クラス、Fakeクラス、テストコードを含めて全て洗い出す
3. 調査結果を踏まえて実装計画を作成する:
   - 実装ステップ（順序と依存関係）
   - 各ファイルの修正内容
   - テスト戦略
   - リスクと注意点
4. 計画書を `docs/specs/{issue番号}.plan.md` に出力する
```

## 出力
- `docs/specs/{issue番号}.spec.md` - 仕様書（requirements-analyst）
- `docs/specs/{issue番号}.plan.md` - 実装計画書（Planエージェント）

## 注意事項
- Phase 1が完了してから Phase 2を開始する
- Planエージェントには仕様書のパスを明示的に渡すこと
- 影響範囲調査では本番コード・テストコード両方を対象にする
